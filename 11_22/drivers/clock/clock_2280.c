/*******************************************************************************
  Copyright (c) 2021 Huajie IMI Technology Co., Ltd.
  All rights reserved.

  @brief        clock driver

  @History
  When          Who             What, where, why
  ----------    ------------    ----------------------------------------

 *******************************************************************************/
#if defined (CHIP_IMI_2280)
#define LOG_TAG		"clock"
#include "clock.h"
#include "string.h"
#include "dev.h"
#include "elog_init.h"
#include "imi_type.h"
#include "initcalls.h"
#include "clock_hw_2280.h"

static const int clk_default[] =
{
	0x80030001,	0x80000002,	0x80000000,	0x80000000,	//0x00
	0x00000003,	0x00000001,	0x00000000,	0x00000001,
	0x80030000,	0x80000000,	0x80000000,	0x80000000,
	0x80000000,	0x00010000,	0x80020002,	0x80000000,
	0x80000002,	0x80000000,	0x00000031,	0x00000000,//0x40
	0x00010000,	0x80000000,	0x80000000,	0x80000000,
	0x80010028,	0x80000002,	0x80010028,	0x80000001,
	0x80000001,	0x80000002,	0x80000002,	0x80000001,
	0x80000001,	0x00010000,	0x80020002,	0x80000003,//0x80
	0x8000000a,	0x80000008,	0x80000003,	0x80000000,
	0x80000000,	0x80000000,	0x80000000,	0x00000000,
	0x80000000,	0x00000000,	0x00000010,	0x80000000,
	0x00000000,	0x00000010,	0x80000000,	0x80000000,//0xc0
	0x80000000,	0x00010000,	0x80010003,	0x80000000,
	0x80000000,	0x80000000,	0x80000000,	0x80000000,
	0x8000000c,	0x80000000,	0x80000000,	0x80000000,
	0x80010005,	0x80010008,	0x80000000,	0x80000000,//0x100, qspi_ref set 120M
	0x80030001,	0x80000000,	0x80000000,	0x80000000,
	0x80000000,	0x80000000,	0x80010001,	0x80000000,
	0x80000000,	0x80000000,	0x80000000,	0x80000000,
	0x80000000,	0x00010006,	0x80000000,	0x80000000,//0x140
	0x80000019,	0x80010002,	0x80030002,	0x80000000,
	0x80000000,	0x80000000,	0x80000000,	0x00000008,
	0x00000000,	0x80000000,	0x80000000,	0x80000002,
	0x80000000,	0x80000000,	0x8001000a,	0x80000000,//0x180
	0x80000000,	0x80000000,	0x80000001,	0x80000000,
	0x80000000,	0x80000000,	0x80000000,	0x80000000,
	0x80000000,	0x80000000,	0x80000000,	0x80000000,
	0x80000000,	0x80000000,	0x80000001,	0x80000000,//0x1c0
	0x80000000,	0x80010000,	0x00000008,	0x80010008,
	0x80000000,	0x80000000,	0x80000000,	0x80000000,
	0x80000000,	0x80000000,	0x80000000,	0x80000000,
	0x80000000,	0x80000000,	0x8000000c,	0x80020003,//0x200
	0x80010001,	0x80000000,	0x80000000,	0x80010008,
	0x80000000,	0x00000008,	0x80000000,	0x80000000,
	0x80000002,	0x80000000,	0x80000000,	0x80000000,
	0x80000000,	0x80000000,	0x80000000,	0x80000000,//0x240
	0x80000000,	0x80000000,	0x00000000,	0x80000000,
	0x80000001,	0x80000000,	0x80000000,	0x80020005,
	0x80000000,	0x80000000,	0x00010006,	0x80000000,
	0x80000000,	0x80000000,	0x80000000,	0x00000008,//0x280
	0x80000000,	0x80000019,	0x80000000,	0x80000000,
	0x80000008,	0x80000000,	0x80000000,	0x80000000,
	0x80000003,	0x00000000,	0x00000000,	0x00000000
};

void imi_2280_clk_default(void)
{
	int i;
	int reg;
	for (i = 0; i < sizeof(clk_default)/sizeof(int); i++) {
		reg = readl(CLK_GEN_BASE_ADDR + i*4);
		if (reg != clk_default[i]) {
			writel(clk_default[i], CLK_GEN_BASE_ADDR + i*4);
//			imi_printf("%s reg %x val %x\n", __func__, CLK_GEN_BASE_ADDR + i*4, clk_default[i]);
		}
	}
}

void clock_set(u32 adress)
{
}

int clock_enable(char* name)
{
	return 0;
}

unsigned int clock_module_set(unsigned int addr, unsigned int value, unsigned int source)
{
	return 0;
}


void clock_dev_init(void)
{

}

CORE_INIT(clock_dev_init);
CORE_INIT(imi_2280_clk_default);
#endif /*CHIP_IMI_2280*/
